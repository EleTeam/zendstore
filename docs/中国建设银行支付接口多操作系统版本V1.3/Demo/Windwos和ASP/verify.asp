

<%@ LANGUAGE = VBScript %>
<%  Option Explicit     %>

<HTML>
<HEAD>
<TITLE>ccbnb verify signature Samples </TITLE>
</HEAD>
<BODY>

建行商户签名测试<P>

<%

    Dim Obj

    ' Create the Java component
    Set Obj = Server.CreateObject("ccb.pub.RSAsig")

    ' Call the method and print the returned string
    Response.Write " pubkey=  30819c300d06092a864886f70d010101050003818a003081860281807b19ab02143341bbe10a387097701b7f7c7325f355bda51f537b01c474cf0e6fdc085f8dfa56e1dfe619b3b92432a07f98a25ca68948f1ff1e289897035a0442c33f4e753cc48f49e47b6ab6583b9912147ec3448eff3d72e581f1463d767081a391313be3ec3b63c6f3491fbf760a16e7376d271cdf90fcc8ab3713aeaeab3d020111"
    Response.Write Obj.setPublicKey("30819c300d06092a864886f70d010101050003818a003081860281807b19ab02143341bbe10a387097701b7f7c7325f355bda51f537b01c474cf0e6fdc085f8dfa56e1dfe619b3b92432a07f98a25ca68948f1ff1e289897035a0442c33f4e753cc48f49e47b6ab6583b9912147ec3448eff3d72e581f1463d767081a391313be3ec3b63c6f3491fbf760a16e7376d271cdf90fcc8ab3713aeaeab3d020111")
    Response.Write " signstring= "
    Response.Write "1fa9fed65958da3cf130ba88794ed48e723d81259d76f26ba058e5d54ab790b6f8ce3573af352924e2c5c7b21174f3cfb7b3b13732c72cc4491126630aba6e73bf41589f839a808b3478fbf701e610da115dd26318290c67f271d44ec045f70b05340f5b8884327101d37fa359508766f0d9a0ff3ae10580b654ef7bc267f034"
    Response.Write " verifyresult="
    Response.Write Obj.verifySigature("1fa9fed65958da3cf130ba88794ed48e723d81259d76f26ba058e5d54ab790b6f8ce3573af352924e2c5c7b21174f3cfb7b3b13732c72cc4491126630aba6e73bf41589f839a808b3478fbf701e610da115dd26318290c67f271d44ec045f70b05340f5b8884327101d37fa359508766f0d9a0ff3ae10580b654ef7bc267f034","POSID=000000000&BRANCHID=110000000&ORDERID=19991101234&PAYMENT=500.00&CURCODE=01&SUCCESS=Y") 


%>

</BODY>
</HTML>
